<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>VSCode with EditorConfig</title>
      <link href="/2023/05/13/VSCode-with-EditorConfig/"/>
      <url>/2023/05/13/VSCode-with-EditorConfig/</url>
      
        <content type="html"><![CDATA[<h3 id="What-is-EditorConfig">What is EditorConfig?</h3><p><a href="https://editorconfig.org/">EditorConfig</a> helps maintain consistent coding styles for multiple developers working on the same project across various editors and IDEs. The EditorConfig project consists of a file format for defining coding styles and a collection of text editor plugins that enable editors to read the file format and adhere to defined styles. EditorConfig files are easily readable and they work nicely with version control systems. <strong>(Excerpt from official documentation)</strong></p><h3 id="Using">Using</h3><ol><li><p>Install EditorConfig<br><img src="/img/vscode_with_editorconfig/01.png" alt="01"></p></li><li><p>Create a <code>.editorconfig</code> file in the root directory of the project<br><img src="/img/vscode_with_editorconfig/02.png" alt="02"></p></li><li><p>Check the <code>Enable Editor Config Support</code><br><img src="/img/vscode_with_editorconfig/03.png" alt="03"></p></li><li><p>Add coding rules<br>Refer to the <a href="https://learn.microsoft.com/en-us/dotnet/fundamentals/code-analysis/style-rules/csharp-formatting-options">official documentation</a>.</p> <figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">root = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">[*]</span><br><span class="line">end_of_line = crlf</span><br><span class="line">insert_final_newline = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">[*.cs]</span><br><span class="line">indent_style = space</span><br><span class="line">indent_size = <span class="number">4</span></span><br><span class="line"><span class="meta">#tab_width = 4</span></span><br><span class="line">charset = utf<span class="number">-8</span>-bom</span><br><span class="line">trim_trailing_whitespace = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">dotnet_sort_system_directives_first = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure></li></ol><h3 id="Other">Other</h3><ul><li>Check the <code>Organize Imports On Format</code> to sort <code>using</code>.<br><img src="/img/vscode_with_editorconfig/04.png" alt="04"></li></ul><h3 id="References">References</h3><ol><li><a href="https://www.neputa-note.net/2020/10/vscode-editorconfig.html">editorconfig for VSCode でコーディングルールを 統一する【C#】</a></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> vscode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Graphics Programmer Roadmap</title>
      <link href="/2023/05/05/Graphics-Programmer-Roadmap/"/>
      <url>/2023/05/05/Graphics-Programmer-Roadmap/</url>
      
        <content type="html"><![CDATA[<h2 id="Introduction">Introduction</h2><p>A graphics programmer is far more than just writing a few lines of Shader code or connecting different lines in <code>ShaderGraph</code>. In my opinion, it typically requires a deep understanding of <code>Computer Graphics Theory</code> and <code>Mathematics</code>. Additionally, one needs to master various graphics APIs such as <code>DirectX</code>, <code>OpenGL</code>, <code>Vulkan</code>, and so on. As a Game-Developer, I focus mainly on real-time graphics technology related to game development.</p><p>In game development, a skilled graphics programmer can make a game look stunning and have highly efficient rendering performance. This is the true skill of a graphics programmer.</p><p>Becoming a graphics programmer requires an enormous amount of learning. If you have the following foundational knowledge, it can make your learning process smoother and easier.</p><ul><li><strong>Language</strong><ul><li>English</li><li>Japanese</li><li>Chinese</li><li>The more languages you know, the better.</li></ul></li><li><strong>Mathematics</strong><ul><li>Calculus</li><li>Linear Algebra</li><li>Probability Theory</li><li>High School Mathematics(Trigonometric functions…)</li><li>Geometry</li></ul></li><li><strong>Programming Languages</strong><ul><li>C++</li><li>C#</li></ul></li><li><strong>Computer Science</strong></li><li><strong>GPU Architecture</strong></li><li><strong>Computer Graphics</strong></li><li>…</li></ul><p>The main purpose of this blog post is to provide some useful resources that the author has learned and found helpful for reference. These resources may include papers, books, source code, and so on.</p><h2 id="Resources">Resources</h2><h3 id="Myself">Myself</h3><ul><li><strong>[GITHUB]</strong> <a href="https://github.com/Talesofwing/Unity-Rendering-Playground">Unity Rendering Playground</a></li><li><strong>[GITHUB]</strong> <a href="https://github.com/Talesofwing/Unity-Shader-Introduction">Unity Shader入門精要 - 筆記</a></li></ul><h3 id="Language">Language</h3><ul><li><strong>[BOOK]</strong> English Grammar in Use</li><li><strong>[BOOK]</strong> Advanced Grammer in Use</li></ul><h3 id="Mathematics">Mathematics</h3><ul><li><strong>[BOOK]</strong> THoMaS’ CalCUlUS</li><li><strong>[VIDEO]</strong> <a href="https://www.youtube.com/watch?v=J7DzL2_Na80&amp;ab_channel=MITOpenCourseWare">MIT 18.06, Linear Algebra</a></li><li><strong>[BOOK]</strong> <a href="http://mathfor3dgameprogramming.com/">Mathematics for 3D Game Programming and Computer Graphics</a></li><li><strong>[BOOK]</strong> <a href="https://www.amazon.co.jp/-/en/Fletcher-Dunn/dp/1568817231">3D Math Primer for Graphics and Game Development</a></li></ul><h3 id="Game-Developement">Game Developement</h3><ul><li><strong>[OTHER]</strong> <a href="https://github.com/miloyip/game-programmer">Game-Programmer Roadmap</a></li></ul><h3 id="Programming-Language">Programming Language</h3><ul><li><strong>[BOOK]</strong> <a href="https://www.amazon.com/Primer-5th-Stanley-B-Lippman/dp/0321714113">C++ Primer</a></li><li><strong>[BOOK]</strong> <a href="https://csharpindepth.com/">C# in Depth</a></li></ul><h3 id="Unity">Unity</h3><ul><li><strong>[BOOK]</strong> <a href="https://github.com/IndieVisualLab/UnityGraphicsProgrammingSeries">IndieVisualLab-Unity Graphics Programming</a></li><li><strong>[BOOK]</strong>  <a href="https://github.com/candycat1992/Unity_Shaders_Book">Unity Shader入門精要</a></li><li><strong>[VIDEO]</strong> Unity Shader簡單黎講, <a href="https://www.youtube.com/watch?v=HgwZYt4po8g&amp;ab_channel=%E7%B0%A1%E5%96%AE%E9%BB%8E%E8%AC%9BCPlusPlus%5B%E5%BB%A3%E6%9D%B1%E8%A9%B1%2CCantonese%5D">Youtube</a> | <a href="https://www.udemy.com/course/unity-shader/">Udemy</a></li></ul><h3 id="Unreal">Unreal</h3><ul><li>NONE…</li></ul><h3 id="DirectX">DirectX</h3><ul><li><strong>[BOOK]</strong> <a href="https://www.d3dcoder.net/d3d12.htm">Introduction to 3D Game Programming with DirectX 12</a></li><li><strong>[BOOK]</strong> <a href="https://www.shoeisha.co.jp/book/detail/9784798161938">DirectX 12の魔導書</a></li></ul><h3 id="OpenGL">OpenGL</h3><ul><li><strong>[ARTICLE]</strong> <a href="https://learnopengl.com/">Learn Open-GL</a></li></ul><h3 id="Computer-Graphics">Computer Graphics</h3><ul><li><strong>[VIDEO]</strong> <a href="https://space.bilibili.com/512313464?spm_id_from=333.337.search-card.all.click">GAMES Series</a></li><li><strong>[BOOK]</strong> Fundamentals of Computer Graphics</li><li><strong>[BOOK]</strong> <a href="https://book.douban.com/subject/30264315/">全局光照技術</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Game Dev </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>VSCode extensions</title>
      <link href="/2023/04/29/VSCode-extensions/"/>
      <url>/2023/04/29/VSCode-extensions/</url>
      
        <content type="html"><![CDATA[<h3 id="Common">Common</h3><table><thead><tr><th>Name</th><th>Desc</th></tr></thead><tbody><tr><td>C/C++</td><td>C/C++ programming extension</td></tr><tr><td>C#</td><td>C# programming extension</td></tr><tr><td>background</td><td>VSCode’s background</td></tr><tr><td>Material Icon Theme</td><td>Design Icons for VSCode</td></tr><tr><td>indent-rainbow</td><td>Makes indentation easier to read</td></tr><tr><td>Markdown Preview Github Styling</td><td>Markdown preview</td></tr><tr><td>Gitlens</td><td>Git tool</td></tr><tr><td>EditorConfig for VSCode</td><td>EditorConfig support for VSCode</td></tr><tr><td>Todo Tree</td><td>Customise the style to display and locate TODOs</td></tr></tbody></table><h3 id="Unity">Unity</h3><table><thead><tr><th>Name</th><th>Desc</th></tr></thead><tbody><tr><td>eppz!</td><td>C# theme for Unity</td></tr><tr><td>Unity3D Meta Files Watcher</td><td>Automatically modifies <code>.meta</code> files in VSCode</td></tr><tr><td>Unity Code Snippets</td><td>Snipptes for Unity3D development</td></tr></tbody></table>]]></content>
      
      
      
        <tags>
            
            <tag> vscode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ray-Tracing: Ray Generation</title>
      <link href="/2022/10/02/cg/ray-tracing/Ray-Tracing-Ray-Generation/"/>
      <url>/2022/10/02/cg/ray-tracing/Ray-Tracing-Ray-Generation/</url>
      
        <content type="html"><![CDATA[<h4 id="前言">前言</h4><p>筆者在GAMES 101的Homework 5，遇到Screen Space -&gt; World Space的問題，所以將思路及其解決方法記錄在此篇文章中。在作業5中，有兩題:</p><ol><li>判斷是否與三角形相交 (Moller-Trumbore)</li><li>得到射線的方向</li></ol><p>此篇文章只說明第2題。</p><h4 id="推導">推導</h4><p>首先，已知Camera的世界座標。並根據代碼，得知投影平面位於Camera的<code>z=-1</code>的位置。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Vector3f dir = <span class="built_in">Vector3f</span> (x, y, <span class="number">-1</span>);</span><br></pre></td></tr></table></figure><p>為了得到射線，需要知道Camera與像素中心之間的方向。所以需要計算像素的世界座標，目前已知<code>z=-1</code>，還需要求出<code>x</code>與<code>y</code>。</p><p>假設屏幕大小為<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi><mo>×</mo><mi>h</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">width \times height</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">i</span><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">h</span><span class="mord mathnormal">e</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span></span></span></span>，起點在左下角，寬高比<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mfrac><mrow><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></mrow><mrow><mi>h</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">A = \frac{width}{height}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3612em;vertical-align:-0.4811em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="mord mathnormal mtight">h</span><span class="mord mathnormal mtight">t</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4811em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>。按照以下的步驟進行計算:</p><ol><li><p>變換到NDC空間中，NDC空間的範圍為<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0, 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>X</mi><mrow><mi>n</mi><mi>d</mi><mi>c</mi></mrow></msub><mo>=</mo><mfrac><mrow><msub><mi>X</mi><mrow><mi>s</mi><mi>c</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>n</mi></mrow></msub><mo>+</mo><mn>0.5</mn></mrow><mrow><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></mrow></mfrac><mspace linebreak="newline" height="0.5019em"></mspace><msub><mi>Y</mi><mrow><mi>n</mi><mi>d</mi><mi>c</mi></mrow></msub><mo>=</mo><mfrac><mrow><msub><mi>Y</mi><mrow><mi>s</mi><mi>c</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>n</mi></mrow></msub><mo>+</mo><mn>0.5</mn></mrow><mrow><mi>h</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">    X_{ndc} = \frac{X_{screen} + 0.5}{width} \\[5px]    Y_{ndc} = \frac{Y_{screen} + 0.5}{height}  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0463em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">i</span><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">scree</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">0.5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline" style="margin-top:0.5019em;"></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2408em;vertical-align:-0.8804em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="mord mathnormal">e</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">scree</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">0.5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p></li><li><p>起點變換至中心</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>X</mi><mo>=</mo><mn>2</mn><mo>×</mo><msub><mi>X</mi><mrow><mi>n</mi><mi>d</mi><mi>c</mi></mrow></msub><mo>−</mo><mn>1</mn><mspace linebreak="newline"></mspace><mi>Y</mi><mo>=</mo><mn>2</mn><mo>×</mo><msub><mi>Y</mi><mrow><mi>n</mi><mi>d</mi><mi>c</mi></mrow></msub><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">    X = 2 \times X_{ndc} - 1 \\    Y = 2 \times Y_{ndc} - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span></p></li><li><p>根據寬高比拉伸</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>X</mi><mo>=</mo><mi>X</mi><mo>×</mo><mi>A</mi><mspace linebreak="newline"></mspace><mi>Y</mi><mo>=</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">    X = X \times A \\    Y = Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span></span></p><p>一般規定了高為2，所以Y不需要改變。</p></li><li><p>FOV控制視野範圍<br>一般FOV有水平和垂直之分，作業中的FOV只有一種，即說明水平和垂直的FOV都一樣。<br>在透視投影中說明的將點投影到近平面上的算式將其逆轉過來，得</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>X</mi><mrow><mi>f</mi><mi>i</mi><mi>n</mi><mi>a</mi><mi>l</mi></mrow></msub><mo>=</mo><mi>X</mi><mo>×</mo><mi>t</mi><mi>a</mi><mi>n</mi><mo stretchy="false">(</mo><mfrac><mrow><mi>f</mi><mi>o</mi><msub><mi>v</mi><mi>x</mi></msub></mrow><mn>2</mn></mfrac><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><msub><mi>Y</mi><mrow><mi>f</mi><mi>i</mi><mi>n</mi><mi>a</mi><mi>l</mi></mrow></msub><mo>=</mo><mi>Y</mi><mo>×</mo><mi>t</mi><mi>a</mi><mi>n</mi><mo stretchy="false">(</mo><mfrac><mrow><mi>f</mi><mi>o</mi><msub><mi>v</mi><mi>y</mi></msub></mrow><mn>2</mn></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">    X_{final} = X \times tan (\frac{fov_x}{2}) \\    Y_{final} = Y \times tan (\frac{fov_y}{2})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mord mathnormal mtight">ina</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">an</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mord mathnormal mtight">ina</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">an</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span></p><p>重溫透視投影的算式(右手座標系)</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mfrac><mrow><mi>x</mi><mi>d</mi></mrow><mrow><mo>−</mo><mi>z</mi></mrow></mfrac><mo>=</mo><mfrac><mi>x</mi><mrow><mo>−</mo><mi>z</mi><mi>t</mi><mi>a</mi><mi>n</mi><mfrac><mi>θ</mi><mn>2</mn></mfrac></mrow></mfrac><mspace linebreak="newline"></mspace><msup><mi>y</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mfrac><mrow><mi>y</mi><mi>d</mi></mrow><mrow><mo>−</mo><mi>z</mi></mrow></mfrac><mo>=</mo><mfrac><mi>y</mi><mrow><mo>−</mo><mi>z</mi><mi>t</mi><mi>a</mi><mi>n</mi><mfrac><mi>θ</mi><mn>2</mn></mfrac></mrow></mfrac></mrow><annotation encoding="application/x-tex">    x&#x27; = \frac{xd}{-z} = \frac{x}{-ztan\frac{\theta}{2}} \\    y&#x27; = \frac{yd}{-z} = \frac{y}{-ztan\frac{\theta}{2}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8019em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1408em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mord mathnormal">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2227em;vertical-align:-1.1151em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.2299em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord mathnormal">t</span><span class="mord mathnormal">an</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1151em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.9963em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1408em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord mathnormal">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.2227em;vertical-align:-1.1151em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.2299em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord mathnormal">t</span><span class="mord mathnormal">an</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1151em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p></li></ol><h4 id="結論">結論</h4><p>整理式子，得:</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>X</mi><mrow><mi>f</mi><mi>i</mi><mi>n</mi><mi>a</mi><mi>l</mi></mrow></msub><mo>=</mo><mn>2</mn><mo>×</mo><mo stretchy="false">(</mo><mfrac><mrow><msub><mi>X</mi><mrow><mi>s</mi><mi>c</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>n</mi></mrow></msub><mo>+</mo><mn>0.5</mn></mrow><mrow><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi></mrow></mfrac><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>×</mo><mi>A</mi><mo>×</mo><mi>t</mi><mi>a</mi><mi>n</mi><mo stretchy="false">(</mo><mfrac><mrow><mi>f</mi><mi>o</mi><msub><mi>v</mi><mi>x</mi></msub></mrow><mn>2</mn></mfrac><mo stretchy="false">)</mo><mspace linebreak="newline" height="0.5019em"></mspace><msub><mi>Y</mi><mrow><mi>f</mi><mi>i</mi><mi>n</mi><mi>a</mi><mi>l</mi></mrow></msub><mo>=</mo><mn>2</mn><mo>×</mo><mo stretchy="false">(</mo><mfrac><mrow><msub><mi>Y</mi><mrow><mi>s</mi><mi>c</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>n</mi></mrow></msub><mo>+</mo><mn>0.5</mn></mrow><mrow><mi>h</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi></mrow></mfrac><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>×</mo><mi>t</mi><mi>a</mi><mi>n</mi><mo stretchy="false">(</mo><mfrac><mrow><mi>f</mi><mi>o</mi><msub><mi>v</mi><mi>y</mi></msub></mrow><mn>2</mn></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">X_{final} = 2 \times (\frac{X_{screen} + 0.5}{width} - 1) \times A \times tan(\frac{fov_x}{2}) \\[5px]Y_{final} = 2 \times (\frac{Y_{screen} + 0.5}{height} - 1)\times tan(\frac{fov_y}{2}) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mord mathnormal mtight">ina</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0463em;vertical-align:-0.686em;"></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">i</span><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">scree</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">0.5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">an</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span><span class="mspace newline" style="margin-top:0.5019em;"></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mord mathnormal mtight">ina</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.2408em;vertical-align:-0.8804em;"></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="mord mathnormal">e</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">scree</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">0.5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">an</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span></p><h4 id="改變觀察方向">改變觀察方向</h4><p>因為作業中的觀察方向是<code>(0, 0, -1)</code>，那麼如何旋轉視角?其實很簡單，只需要將求得的<code>dir</code>乘以旋轉矩陣便可。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 求得的dir</span></span><br><span class="line">Vector3f dir = <span class="built_in">Vector3f</span> (x, y, <span class="number">-1</span>);</span><br><span class="line"><span class="type">float</span> angle = <span class="number">45</span>;</span><br><span class="line">Vector3f new_dir = <span class="built_in">get_x_rotation_matrix</span> (angle) * dir;</span><br></pre></td></tr></table></figure><p>相當於將Camera(投影平面)旋轉了45度角。</p><h4 id="References">References</h4><p><a href="https://www.scratchapixel.com/lessons/3d-basic-rendering/ray-tracing-generating-camera-rays/generating-camera-rays">Ray-Tracing: Generating Camera Rays</a><br><a href="https://blog.csdn.net/Q_pril/article/details/123825665">GAMES 101: 作業5解析</a></p>]]></content>
      
      
      <categories>
          
          <category> Computer Graphics </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cg </tag>
            
            <tag> ray-tracing </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DirectX 12 - Descriptor &amp; RootSignature</title>
      <link href="/2022/09/04/directx/DirectX-12-Descriptor-RootSignature/"/>
      <url>/2022/09/04/directx/DirectX-12-Descriptor-RootSignature/</url>
      
        <content type="html"><![CDATA[<h3 id="前言">前言</h3><p>筆者也是初入圖形學坑的菜鳥，並不是甚麼資深程序員。如果有錯誤之處，請指出，筆者會立刻進行修改。</p><p>接觸DirectX 12時，有很多覺得困惑的地方，其中便是<code>Descriptor(View)</code>與<code>RootSignature</code>的關係。筆者相信也有很多初學者有相同的疑問。所以借此篇博文，儘可能地解釋清楚兩者之間的關係。</p><h3 id="Descriptor-Heap-Descriptor-View">Descriptor Heap &amp; Descriptor &amp; View</h3><p>在說明RootSinature前，首先要理清Heap和Descriptor和View之間的關係。</p><h4 id="Descriptor與View">Descriptor與View</h4><p>在dx12中descriptor與View是等價的(請參閱<a href="https://stackoverflow.com/questions/56821782/what-is-the-difference-between-a-resource-and-a-resource-view">這裏</a>)。descriptor有</p><ul><li>DSV (Depth Stencil View)</li><li>RTV (Render Target View)</li><li>SRV (Shader Resource View)</li><li>CBV (Constant Buffer View)</li><li>UAV (Unordered Access View)</li><li>Sampler</li></ul><p>descriptor實際上是對buffer的描述，存儲了resource的地址以及大小。以CBV為例</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">D3D12_CONSTANT_BUFFER_VIEW_DESC cbvDesc;</span><br><span class="line">cbvDesc.BufferLocation = cBuffer-&gt;<span class="built_in">GetGPUVirtualAddress</span> ();</span><br><span class="line">cbvDesc.SizeInBytes = objCBByteSize;</span><br><span class="line">device-&gt;<span class="built_in">CreateConstantBufferView</span> (&amp;cbvDesc, cbvHeap-&gt;<span class="built_in">GetCPUDescriptorHandleForHeapStart</span> ());</span><br></pre></td></tr></table></figure><p>保存了constant_buffer的內存地址以及其大小。</p><p><img src="/img/dx/descriptor/01.png" alt=""></p><div class="img-alt is-center">Descriptor與Resource的關係</div><h4 id="Descriptor-Heap">Descriptor Heap</h4><p>Descriptor Heap是descriptor的堆。存放大量相同類型的descriptor。依然以CBV為例</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">D3D12_DESCRIPTOR_HEAP_DESC cbvHeapDesc;</span><br><span class="line">cbvHeapDesc.NumDescriptors = <span class="number">1</span>;</span><br><span class="line">cbvHeapDesc.NodeMask = <span class="number">0</span>;</span><br><span class="line">cbvHeapDesc.Type = D3D12_DESCRIPTOR_HEAP_TYPE_CBV_SRV_UAV;</span><br><span class="line">cbvHeapDesc.Flags = D3D12_DESCRIPTOR_HEAP_FLAG_SHADER_VISIBLE;</span><br><span class="line">m_Device-&gt;<span class="built_in">CreateDescriptorHeap</span> (&amp;cbvHeapDesc, <span class="built_in">IID_PPV_ARGS</span> (&amp;m_CBVHeap));</span><br></pre></td></tr></table></figure><p>這個Heap中保存一個Descriptor，其類型為<code>CBV_SRV_UAV</code>。</p><p><img src="/img/dx/descriptor/02.png" alt=""></p><div class="img-alt is-center">Descriptor Heap</div><h4 id="Why-descriptor">Why descriptor?</h4><p>正如在<code>Descriptor與View</code>小節中提到，descriptor是對buffer的一種描述。buffer就是一堆數據，而這些數據可以有不同的用途，由descriptor解釋。例如一buffer作為渲染目標時，被descriptor解釋為RTV。得到的貼圖buffer可以再被解釋為SRV，作為Shader的資源使用。</p><h3 id="Descriptor與RootSignature">Descriptor與RootSignature</h3><h4 id="Shader是一個大函數">Shader是一個大函數</h4><p>為了能簡單地理解RootSiangature，我們將Shader看作是一個大函數，而RootSiganture則是說明了Shader函數的參數格式。</p><p>參數的類型有三種</p><ul><li>Descriptor Table : Descriptor數組</li><li>Root Descriptor : 單一Descriptor</li><li>Root Constant : 常數</li></ul><p>即，程序員可以為Shader函數準備: descriptor的數組、單一的descriptor、常數項的參數。以Descriptor Table為例</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">D3D12_DESCRIPTOR_RANGE descTblRange = &#123;&#125;;</span><br><span class="line">descTblRange.NumDescriptors = <span class="number">1</span>;</span><br><span class="line">descTblRange.RangeType = D3D12_DESCRIPTOR_RANGE_TYPE_CBV;</span><br><span class="line">descTblRange.BaseShaderRegister = <span class="number">0</span>;</span><br><span class="line">descTblRange.OffsetInDescriptorsFromTableStart = D3D12_DESCRIPTOR_RANGE_OFFSET_APPEND;</span><br><span class="line"></span><br><span class="line">D3D12_ROOT_PARAMETER rootparam = &#123;&#125;;</span><br><span class="line">rootparam.ParameterType = D3D12_ROOT_PARAMETER_TYPE_DESCRIPTOR_TABLE;</span><br><span class="line">rootparam.DescriptorTable.pDescriptorRanges = &amp;descTblRange;</span><br><span class="line">rootparam.DescriptorTable.NumDescriptorRanges = <span class="number">1</span>;</span><br><span class="line">rootparam.ShaderVisibility = D3D12_SHADER_VISIBILITY_VERTEX;</span><br><span class="line"></span><br><span class="line">D3D12_ROOT_SIGNATURE_DESC rootSigDesc = &#123;&#125;;</span><br><span class="line">rootSigDesc.Flags = D3D12_ROOT_SIGNATURE_FLAG_ALLOW_INPUT_ASSEMBLER_INPUT_LAYOUT;</span><br><span class="line">rootSigDesc.pParameters = &amp;rootparam;</span><br><span class="line">rootSigDesc.NumParameters = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// build rootsignature...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// draw...</span></span><br><span class="line"></span><br><span class="line">ID3D12DescriptorHeap* descriptorHeaps[] = &#123;cbvHeap.<span class="built_in">Get</span> ()&#125;;</span><br><span class="line">cmdList-&gt;<span class="built_in">SetGraphicsRootSignature</span> (rootSignature.<span class="built_in">Get</span> ());</span><br><span class="line">cmdList-&gt;<span class="built_in">SetDescriptorHeaps</span> (_countof (descriptorHeaps), descriptorHeaps);</span><br><span class="line">cmdList-&gt;<span class="built_in">SetGraphicsRootDescriptorTable</span> (<span class="number">0</span>, cbvHeap-&gt;<span class="built_in">GetGPUDescriptorHandleForHeapStart</span> ());</span><br><span class="line"></span><br><span class="line"><span class="comment">// draw...</span></span><br></pre></td></tr></table></figure><p>設置了一個descriptor數組作為參數，這個數組中存在一個CBV。在渲染時，利用命令將要使用的DescriptorHeap以及Heap的起始地址設置好便可。</p><h3 id="總結">總結</h3><p>descriptor就是view，用於描述buffer的，給出了buffer的作用。而descriptor heap是保存descriptor的堆。rootsignature說明shader函數的參數格式。MSDN提供的圖片能更好地說明它們之間的關係</p><p><img src="/img/dx/descriptor/03.png" alt="MSDN"></p><div class="img-alt is-center">MSDN</div><p>References</p><ul><li><a href="https://docs.microsoft.com/en-us/windows/win32/direct3d12/pipelines-and-shaders-with-directx-12#direct3d-12-graphics-pipeline">MSDN - dx12 graphics pipeline</a></li><li>DirectX 12の魔導書</li><li>DirectX 12 3D游戏开发实战</li></ul>]]></content>
      
      
      <categories>
          
          <category> DirectX </category>
          
      </categories>
      
      
        <tags>
            
            <tag> directx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Light Falloff(Point Light)</title>
      <link href="/2022/08/28/cg/Light-Falloff-Point-Light/"/>
      <url>/2022/08/28/cg/Light-Falloff-Point-Light/</url>
      
        <content type="html"><![CDATA[<h4 id="Introduction">Introduction</h4><p>The light of the point light source is diffused outward in the shape of a sphere. As the diffusion distance increases, the amount of light energy per unit surface area of the sphere becomes smaller and smaller.</p><p>What is the calculation for light energy?</p><h4 id="Calculation">Calculation</h4><p><img src="/img/cg/light_falloff/01.png" alt="Light Falloff"></p><div class="img-alt is-center">GAMES 101</div><p>In the figure, the unit light energy of a sphere at radius 1 is set to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">I_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, and at radius r is set to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">I_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.</p><p>According to <code>the law of conservation of energy</code>, the total energy is constant, so we obtain the equation</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>I</mi><mn>1</mn></msub><mn>4</mn><mi>π</mi><msup><mn>1</mn><mn>2</mn></msup><mo>=</mo><msub><mi>I</mi><mn>2</mn></msub><mn>4</mn><mi>π</mi><msup><mi>r</mi><mn>2</mn></msup><mspace linebreak="newline" height="0.5019em"></mspace><msub><mi>I</mi><mn>2</mn></msub><mo>=</mo><mfrac><mrow><msub><mi>I</mi><mn>1</mn></msub><mn>4</mn><mi>π</mi></mrow><mrow><mn>4</mn><mi>π</mi><msup><mi>r</mi><mn>2</mn></msup></mrow></mfrac><mspace linebreak="newline" height="0.5019em"></mspace><msub><mi>I</mi><mn>2</mn></msub><mo>=</mo><mfrac><msub><mi>I</mi><mn>1</mn></msub><msup><mi>r</mi><mn>2</mn></msup></mfrac></mrow><annotation encoding="application/x-tex">I_1 4\pi 1^2 = I_24\pi r^2  \\[5px]I_2 = \frac{I_14\pi}{4\pi r^2} \\[5px]I_2 = \frac{I_1}{r^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0141em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">4</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0141em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">4</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace newline" style="margin-top:0.5019em;"></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0463em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">4</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline" style="margin-top:0.5019em;"></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0463em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><h4 id="References">References</h4><p><a href="https://www.bilibili.com/video/BV1X7411F744/?p=1&amp;vd_source=086040f0a7a965e1d2adee44a522d00d">GAMES 101-現代計算機圖形學入門-闫令琪</a></p>]]></content>
      
      
      <categories>
          
          <category> Computer Graphics </category>
          
          <category> Shading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> radiometry </tag>
            
            <tag> cg </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>照射到物體表面時光線間的距離推導</title>
      <link href="/2022/08/21/cg/lighting-distance/"/>
      <url>/2022/08/21/cg/lighting-distance/</url>
      
        <content type="html"><![CDATA[<h4 id="問題">問題</h4><p>Question. 非垂直光中的光線間的距離怎麼求解?</p><table><thead><tr><th><img src="/img/cg/lighting_distance/01.png" alt="垂直光線">a. 垂直光線</th><th><img src="/img/cg/lighting_distance/02.png" alt="非垂直光線"> b. 非垂直光線</th></tr></thead></table><h4 id="前言">前言</h4><p>因為筆者在閱讀Unity Shader入門精要<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">^{(1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span>時，花了一點時間才完成推導，所以籍此文章記錄過程。</p><h4 id="推導">推導</h4><table><thead><tr><th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><mfrac><mi>d</mi><mrow><mi>cos</mi><mo>⁡</mo><mi>θ</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">L = \frac{d}{\cos\theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2251em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">c</span><span class="mtight">o</span><span class="mtight">s</span></span><span class="mspace mtight" style="margin-right:0.1952em;"></span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></th></tr></thead><tbody><tr><td><img src="/img/cg/lighting_distance/03.png" alt=""></td></tr></tbody></table><p>因為直角三角形中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>的另一個非直角角度為<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>90</mn><mo>−</mo><mi>θ</mi></mrow><annotation encoding="application/x-tex">90-\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">90</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span>，所以有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mi>θ</mi></mrow><annotation encoding="application/x-tex">\alpha = \theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span>。<br>根據三角函數，有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mi>α</mi><mo>=</mo><mfrac><mi>d</mi><mi>L</mi></mfrac></mrow><annotation encoding="application/x-tex">cos \alpha = \frac{d}{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">cos</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2251em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><br>得<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><mfrac><mi>d</mi><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mi>α</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">L = \frac{d}{cos \alpha}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2251em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">cos</span><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>，所以有</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>L</mi><mo>=</mo><mfrac><mi>d</mi><mrow><mi>cos</mi><mo>⁡</mo><mi>θ</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">L = \frac{d}{\cos\theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">cos</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><h4 id="參考資料">參考資料</h4><ol><li>馮樂樂(2016), Unity Shader入門精要, 人民郵電出版社</li><li><a href="https://www.bilibili.com/video/BV1X7411F744/?p=1">GAMES 101-現代計算機圖形學入門-闫令琪</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Computer Graphics </category>
          
          <category> Shading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> radiometry </tag>
            
            <tag> cg </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Introduction of Multisampling(MSAA)</title>
      <link href="/2022/08/05/cg/anti-aliasing/Introduction-of-Multisampling-MSAA/"/>
      <url>/2022/08/05/cg/anti-aliasing/Introduction-of-Multisampling-MSAA/</url>
      
        <content type="html"><![CDATA[<div class="tabs" id="tab"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1">中文</button></li><li class="tab"><button type="button" data-href="#tab-2">日本語</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1"><h4 id="前言">前言</h4><blockquote><p>如果不了解SSAA，請先到SSAA頁面查看</p></blockquote><p>MSAA(Multisampling Anti-Aliasing)的做法與SSAA基本一致，也是通過增加像素提高取樣率，唯一的不同是取樣的方式。SSAA是增加的所有像素都需要執行着色計算，而MSAA則是只對原像素進行一次着色操作，再將着色得到的值傳給通過了光柵化測試等的像素中。</p><h4 id="MSAA著色">MSAA著色</h4><p>因為MSAA的著色與SSAA極為相似，所以在很多情況下，結果與SSAA並無二致。</p><p><img src="/img/cg/msaa/01.png" alt="01"></p><div class="img-alt is-center">origin</div><p><img src="/img/cg/msaa/02.png" alt="02"></p><div class="img-alt is-center">4x SSAA</div><p>將原像素中著色得到的值，賦值給通過一系列測試的像素。</p><p>但是當一個三角形有漸層變色時，在變色處會容易取樣到錯誤的顏色。如下圖，原像素取樣得到綠色。將綠色賦值給通過一系列測試的像素。明顯，這個結果並不正確。</p><p><img src="/img/cg/msaa/03.png" alt="03"></p><div class="img-alt is-center">origin</div><p><img src="/img/cg/msaa/04.png" alt="04"></p><div class="img-alt is-center">4x MSAA</div><p>如果採用SSAA，結果會比MSAA準確。如下圖</p><p><img src="/img/cg/msaa/05.png" alt="05"></p><div class="img-alt is-center">4x SSAA</div><p>雖然MSAA比不上SSAA。但是由於MSAA的速度比SSAA快且得到的結果與SSAA相差不大。因此，在real-time渲染中，一般會選用MSAA而不是SSAA。</p><h4 id="與SSAA相比">與SSAA相比</h4><ol><li>MSAA的速度與原取樣速度基本一致，多了一些步驟(查詢值、賦值、求平均操作…)</li><li>MSAA與SSAA所佔存儲空間一致</li><li>MSAA的質量沒有SSAA好</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-2"><h4 id="前書き">前書き</h4><blockquote><p>SSAAをまだわからない方が、まずSSAAを見てください</p></blockquote><p>MSAA(Multisampling Anti-Aliasing)はSSAAとほぼ同じの手法である。解像度を増加し、サンプリング周波数を増大する。違うところはシェーディングの方法だけである。</p><p>SSAAはピクセルごとにシェーディングを行うが、MSAAは元ピクセルにシェーディングを1回行い、計算された値をピクセルの値とする。</p><h4 id="MSAAのシェーディンググ">MSAAのシェーディンググ</h4><p>MSAAはSSAAと似っているため、多くの場合、同じの結果になる。</p><p><img src="/img/cg/msaa/01.png" alt="01"></p><div class="img-alt is-center">origin</div><p>元ピクセルで計算された値をピクセルの値とする。</p><p><img src="/img/cg/msaa/02.png" alt="02"></p><div class="img-alt is-center">4x MSAA</div><p>しかし、三角形にグラデーションがあると、変色箇所で誤った色がサンプリングされやすくなる。</p><p><img src="/img/cg/msaa/03.png" alt="03"></p><div class="img-alt is-center">origin</div><p>最後の結果は緑色ですが、正しいではない。</p><p><img src="/img/cg/msaa/04.png" alt="04"></p><div class="img-alt is-center">4x MSAA</div><p>もし、SSAAを使用したら、結果はMSAAを使用するよりも良くなります。</p><p><img src="/img/cg/msaa/05.png" alt="05"></p><div class="img-alt is-center">4x SSAA</div><p>MSAAはSSAAのより品質が低いですが、高速な計算ができるため、レアルタイムレンダリングでよく使用されている。</p><h4 id="SSAAとの比較">SSAAとの比較</h4><ol><li>MSAAのほうが速い</li><li>MSAAとSSAAは同じストレージが必要</li><li>SSAAのほうがきれい</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="References">References</h4><p><a href="https://0-rpg.com/2022/08/28/cg/Introducation-of-Supersampling-Anti-Aliasing-SSAA/">Introducation of Supersampling Anti-Aliasing(SSAA)</a></p>]]></content>
      
      
      <categories>
          
          <category> Computer Graphics </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cg </tag>
            
            <tag> anti-aliasing </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Introducation of Supersampling Anti-Aliasing(SSAA)</title>
      <link href="/2022/08/05/cg/anti-aliasing/Introducation-of-Supersampling-Anti-Aliasing-SSAA/"/>
      <url>/2022/08/05/cg/anti-aliasing/Introducation-of-Supersampling-Anti-Aliasing-SSAA/</url>
      
        <content type="html"><![CDATA[<div class="tabs" id="tab"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1">中文</button></li><li class="tab"><button type="button" data-href="#tab-2">日本語</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1"><h4 id="前言">前言</h4><p>SSAA(Supersampling Anti-Aliasing)是通過加大分辨率，使取樣率提高的一種反鋸齒技術。以4xSSAA為例，屏幕像素被放大4倍進行取樣。</p><p><img src="/img/cg/ssaa/01.png" alt="4x SSAA"></p><p>所有着色完成後，計算4個像素的平均值，賦值給原像素。</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>p</mi><mi>n</mi></msub><mo>=</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mn>4</mn></munderover><msub><mi>P</mi><mi>i</mi></msub></mrow><mn>4</mn></mfrac></mrow><annotation encoding="application/x-tex">p_{n} = \frac{\sum_{i=0}^4 P_{i}}{4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3297em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6437em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.6897em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.954em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><h4 id="鋸齒">鋸齒</h4><p>因為像素的取樣率不足，導致不能完整地描述三角形。</p><p><img src="/img/cg/ssaa/02.png" alt="4x SSAA"></p><p>通過增大分辦率(軟件形式)，提高像素的取樣率，能更好地描述三角形。</p><p><img src="/img/cg/ssaa/03.png" alt="4x SSAA"></p><p>實際的顯示中，因為邊緣被模糊了，所以鋸齒感會降低。</p><h4 id="SSAA著色">SSAA著色</h4><p>原本的著色是針對一個像素的，如下圖。</p><p><img src="/img/cg/ssaa/04.png" alt="origin"></p><div class="img-alt is-center">origin</div><p>SSAA是逐像素計算的，每一個像素都需要執行着色運算(與MSAA不同之處)。當着色結束後，求4個像素的平均值，賦給原像素。下圖中的結果為</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mi>i</mi><mi>x</mi><mi>e</mi><mi>l</mi><mo>=</mo><mfrac><mrow><mn>2</mn><mi>g</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>n</mi></mrow><mn>4</mn></mfrac></mrow><annotation encoding="application/x-tex">pixel = \frac{2green}{4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">i</span><span class="mord mathnormal">x</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">ree</span><span class="mord mathnormal">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><img src="/img/cg/ssaa/05.png" alt="a triangle"></p><div class="img-alt is-center">a triangle</div><p>因為着色時會進行深度測試(depth testing)，存在多個三角形時，會根據深度值進行屏蔽。下圖中的結果為</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mi>i</mi><mi>x</mi><mi>e</mi><mi>l</mi><mo>=</mo><mfrac><mrow><mn>2</mn><mi>y</mi><mi>e</mi><mi>l</mi><mi>l</mi><mi>o</mi><mi>w</mi><mo>+</mo><mn>1</mn><mi>g</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>n</mi></mrow><mn>4</mn></mfrac></mrow><annotation encoding="application/x-tex">pixel = \frac {2yellow + 1green}{4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">i</span><span class="mord mathnormal">x</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathnormal">ye</span><span class="mord mathnormal" style="margin-right:0.01968em;">ll</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">ree</span><span class="mord mathnormal">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><img src="/img/cg/ssaa/06.png" alt="more triangle"></p><div class="img-alt is-center">more triangle</div><h4 id="問題">問題</h4><ol><li>4倍的存儲空間(渲染貼圖&amp;深度貼圖)</li><li>4倍的着色計算</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-2"><h4 id="前書き">前書き</h4><p>SSAA(Supersampling Anti-Aliasing)とは解像度を増加し、サンプリング周波数を増大するアンチエイリアス技術である。4xSSAAを例とし、解像度を4倍増加して、サンプリングを行う。</p><p><img src="/img/cg/ssaa/01.png" alt="4x SSAA"></p><p>シェーディングが終わと、元ピクセルの値は4つのピクセルの平均である。</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>p</mi><mi>n</mi></msub><mo>=</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mn>4</mn></munderover><msub><mi>P</mi><mi>i</mi></msub></mrow><mn>4</mn></mfrac></mrow><annotation encoding="application/x-tex">p_{n} = \frac{\sum_{i=0}^4 P_{i}}{4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3297em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6437em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.6897em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.954em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><h4 id="アンチエイリアス">アンチエイリアス</h4><p>サンプリング周波数が足りないため、三角形を完璧に表現できない。</p><p><img src="/img/cg/ssaa/02.png" alt="4x SSAA"></p><p>解像度を増加することにより(ソフトウェア側)、サンプリング周波数を上げ、三角形の表現がよくなる。</p><p><img src="/img/cg/ssaa/03.png" alt="4x SSAA"></p><h4 id="SSAAのシェーディンググ">SSAAのシェーディンググ</h4><p>原画像のサンプリングでは、次の図のように1か所しかシェーディングできない。</p><p><img src="/img/cg/ssaa/04.png" alt="origin"></p><div class="img-alt is-center">origin</div><p>SSAAは<code>per pixel</code>で、ピクセルごとにシェーディングを行う(MSAAとの違い)。シェーディングが終わると、4つのピクセルの平均値を元ピクセルの値にする。下図の結果は</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mi>i</mi><mi>x</mi><mi>e</mi><mi>l</mi><mo>=</mo><mfrac><mrow><mn>2</mn><mi>g</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>n</mi></mrow><mn>4</mn></mfrac></mrow><annotation encoding="application/x-tex">pixel = \frac{2green}{4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">i</span><span class="mord mathnormal">x</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">ree</span><span class="mord mathnormal">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><img src="/img/cg/ssaa/05.png" alt="a triangle"></p><div class="img-alt is-center">a triangle</div><p>シェーディングする時、深度テストを行うため、複数の三角形が存在する場合としても、正しい結果が出る。下図の結果は</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mi>i</mi><mi>x</mi><mi>e</mi><mi>l</mi><mo>=</mo><mfrac><mrow><mn>2</mn><mi>y</mi><mi>e</mi><mi>l</mi><mi>l</mi><mi>o</mi><mi>w</mi><mo>+</mo><mn>1</mn><mi>g</mi><mi>r</mi><mi>e</mi><mi>e</mi><mi>n</mi></mrow><mn>4</mn></mfrac></mrow><annotation encoding="application/x-tex">pixel = \frac {2yellow + 1green}{4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">i</span><span class="mord mathnormal">x</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathnormal">ye</span><span class="mord mathnormal" style="margin-right:0.01968em;">ll</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">ree</span><span class="mord mathnormal">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><img src="/img/cg/ssaa/06.png" alt="more triangle"></p><div class="img-alt is-center">more triangle</div><h4 id="問題">問題</h4><ol><li>4倍のストレージ(RenderTarget Texture &amp; Depth Texture)</li><li>4倍の計算時間</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="References">References</h4><p><a href="https://0-rpg.com/2022/08/05/cg/Introducation-of-MultisamplingAnti-Aliasing-MSAA/">Introduction of Multisampling(MSAA)</a></p>]]></content>
      
      
      <categories>
          
          <category> Computer Graphics </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cg </tag>
            
            <tag> anti-aliasing </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DirectX 12 - Multisampling(MSAA)</title>
      <link href="/2022/08/05/directx/DirectX-12-Multisampling-MSAA/"/>
      <url>/2022/08/05/directx/DirectX-12-Multisampling-MSAA/</url>
      
        <content type="html"><![CDATA[<blockquote><p>Environment:</p><ul><li>DirectX 12</li><li>Windows 10</li><li>Visual Studio 2019</li></ul></blockquote><h3 id="前言">前言</h3><p>在「INTRODUCTION TO 3D GAME PROGRAMMING WITH DIRECTX 12」一書中，示例代碼使用<code>MSAA</code>的方式已經過時，所以導致出現錯誤。這是因為在新版DirectX 12中，不能在運行時修改交換鏈(SwapChain)。為了使用<code>MSAA</code>，需要作出修改，本文使用的示例是Chapter 6中的Box。</p><img src="/img/dx/dx12_book.png" alt="INTRODUCTION TO 3D GAME PROGRAMMING WITH DIRECTX 12"><div class="img-alt is-center">INTRODUCTION TO 3D GAME PROGRAMMING WITH DIRECTX 12</div><h3 id="修改">修改</h3><p>主要步驟:</p><ol><li>創建MSAA用的RenderTarget</li><li>創建MSAA用的DepthStencil</li><li>創建MSAA用的Pipeline</li></ol><blockquote><p><strong>Notice:</strong> SwapChain不需要修改</p></blockquote><h4 id="創建RTV">創建RTV</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">ID3D12Resource* msaaRenderTarget;</span><br><span class="line">D3D12_DESCRIPTOR_HEAP_DESC msaaRTVHeapDesc;</span><br><span class="line">msaaRTVHeapDesc.NumDescriptors = <span class="number">1</span>;</span><br><span class="line">msaaRTVHeapDesc.Type = D3D12_DESCRIPTOR_HEAP_TYPE_RTV;</span><br><span class="line">msaaRTVHeapDesc.Flags = D3D12_DESCRIPTOR_HEAP_FLAG_NONE;</span><br><span class="line">msaaRTVHeapDesc.NodeMask = <span class="number">0</span>;</span><br><span class="line">device-&gt;<span class="built_in">CreateDescriptorHeap</span> (&amp;msaaRTVHeapDesc, <span class="built_in">IID_PPV_ARGS</span> (&amp;msaaRTVHeap));</span><br><span class="line"></span><br><span class="line">D3D12_RESOURCE_DESC msaaResourceDesc = CD3DX12_RESOURCE_DESC::<span class="built_in">Tex2D</span> (</span><br><span class="line">    DXGI_FORMAT_R8G8B8A8_UNORM,</span><br><span class="line">    window_width,</span><br><span class="line">    window_height,</span><br><span class="line">    <span class="number">1</span>,<span class="comment">// ArraySize</span></span><br><span class="line">    <span class="number">1</span>,<span class="comment">// MipLevels</span></span><br><span class="line">    <span class="number">4</span><span class="comment">// msaa採樣次數</span></span><br><span class="line">);</span><br><span class="line">msaaResourceDesc.Flags |= D3D12_RESOURCE_FLAG_ALLOW_RENDER_TARGET;</span><br><span class="line"></span><br><span class="line">device-&gt;<span class="built_in">CreateCommittedResource</span> (</span><br><span class="line">    &amp;<span class="built_in">CD3DX12_HEAP_PROPERTIES</span> (D3D12_HEAP_TYPE_DEFAULT),</span><br><span class="line">    D3D12_HEAP_FLAG_NONE,</span><br><span class="line">    &amp;msaaResourceDesc,</span><br><span class="line">    D3D12_RESOURCE_STATE_RESOLVE_SOURCE,<span class="comment">// 不是Render Target</span></span><br><span class="line">    &amp;msaaOptimizedClearValue,</span><br><span class="line">    <span class="built_in">IID_PPV_ARGS</span> (&amp;msaaRenderTarget)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">D3D12_RENDER_TARGET_VIEW_DESC msaaRTVDesc = &#123;&#125;;</span><br><span class="line">msaaRTVDesc.Format = DXGI_FORMAT_R8G8B8A8_UNORM;</span><br><span class="line">msaaRTVDesc.ViewDimension = D3D12_RTV_DIMENSION_TEXTURE2DMS;</span><br><span class="line">device-&gt;<span class="built_in">CreateRenderTargetView</span> (msaaRenderTarget, &amp;msaaRTVDesc, msaaRTVHeap-&gt;<span class="built_in">GetCPUDescriptorHandleForHeapStart</span> ());</span><br></pre></td></tr></table></figure><p>注意在<code>CreateCommittedResource ()</code>中的State是<code>D3D12_RESOURCE_STATE_RESOLVE_SOURCE</code>，而不是<code>D3D12_RESOURCE_STATE_RENDER_TARGET</code>。</p><h4 id="創建DSV">創建DSV</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">ID3D12Resource* msaaDepthStencil;</span><br><span class="line">D3D12_DESCRIPTOR_HEAP_DESC msaaDSVHeapDesc;</span><br><span class="line">msaaDSVHeapDesc.NumDescriptors = <span class="number">1</span>;</span><br><span class="line">msaaDSVHeapDesc.Type = D3D12_DESCRIPTOR_HEAP_TYPE_DSV;</span><br><span class="line">msaaDSVHeapDesc.Flags = D3D12_DESCRIPTOR_HEAP_FLAG_NONE;</span><br><span class="line">msaaDSVHeapDesc.NodeMask = <span class="number">0</span>;</span><br><span class="line">device-&gt;<span class="built_in">CreateDescriptorHeap</span> (&amp;msaaDSVHeapDesc, <span class="built_in">IID_PPV_ARGS</span> (&amp;msaaDSVHeap));</span><br><span class="line"></span><br><span class="line">D3D12_RESOURCE_DESC msaaDepthStencilDesc = CD3DX12_RESOURCE_DESC::<span class="built_in">Tex2D</span> (</span><br><span class="line">    DXGI_FORMAT_D24_UNORM_S8_UINT,</span><br><span class="line">    window_width,</span><br><span class="line">    window_height,</span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    <span class="number">4</span></span><br><span class="line">);</span><br><span class="line">msaaDepthStencilDesc.Flags |= D3D12_RESOURCE_FLAG_ALLOW_DEPTH_STENCIL;</span><br><span class="line"></span><br><span class="line">D3D12_CLEAR_VALUE depthOptimizedClearValue = &#123;&#125;;</span><br><span class="line">depthOptimizedClearValue.Format = DXGI_FORMAT_D24_UNORM_S8_UINT;</span><br><span class="line">depthOptimizedClearValue.DepthStencil.Depth = <span class="number">1.0f</span>;</span><br><span class="line">depthOptimizedClearValue.DepthStencil.Stencil = <span class="number">0.0f</span>;</span><br><span class="line"></span><br><span class="line">device-&gt;<span class="built_in">CreateCommittedResource</span> (</span><br><span class="line">    &amp;<span class="built_in">CD3DX12_HEAP_PROPERTIES</span> (D3D12_HEAP_TYPE_DEFAULT),</span><br><span class="line">    D3D12_HEAP_FLAG_NONE,</span><br><span class="line">    &amp;msaaDepthStencilDesc,</span><br><span class="line">    D3D12_RESOURCE_STATE_DEPTH_WRITE,</span><br><span class="line">    &amp;depthOptimizedClearValue,</span><br><span class="line">    <span class="built_in">IID_PPV_ARGS</span> (&amp;msaaDepthStencil)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">D3D12_DEPTH_STENCIL_VIEW_DESC msaaDSVDesc = &#123;&#125;;</span><br><span class="line">msaaDSVDesc.Format = DXGI_FORMAT_D24_UNORM_S8_UINT;</span><br><span class="line">msaaDSVDesc.ViewDimension = D3D12_DSV_DIMENSION_TEXTURE2DMS;</span><br><span class="line">device-&gt;<span class="built_in">CreateDepthStencilView</span> (msaaDepthStencil, &amp;msaaDSVDesc, msaaDSVHeap-&gt;<span class="built_in">GetCPUDescriptorHandleForHeapStart</span> ());</span><br></pre></td></tr></table></figure><p>基本與RTV相同。</p><h4 id="創建Pipeline">創建Pipeline</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">D3D12_GRAPHICS_PIPELINE_STATE_DESC msaaPSODesc;</span><br><span class="line"><span class="built_in">ZeroMemory</span> (&amp;msaaPSODesc, <span class="built_in">sizeof</span> (D3D12_GRAPHICS_PIPELINE_STATE_DESC));</span><br><span class="line">msaaPSODesc.InputLayout = &#123;inputLayout.<span class="built_in">data</span> (), (UINT)inputLayout.<span class="built_in">size</span> ()&#125;;</span><br><span class="line">msaaPSODesc.pRootSignature = rootSignature;</span><br><span class="line">msaaPSODesc.VS = &#123;</span><br><span class="line">vsByteCode-&gt;<span class="built_in">GetBufferPointer</span> (),</span><br><span class="line">vsByteCode-&gt;<span class="built_in">GetBufferSize</span> ()</span><br><span class="line">&#125;;</span><br><span class="line">msaaPSODesc.PS = &#123;</span><br><span class="line">psByteCode-&gt;<span class="built_in">GetBufferPointer</span> (),</span><br><span class="line">psByteCode-&gt;<span class="built_in">GetBufferSize</span> ()</span><br><span class="line">&#125;;</span><br><span class="line">msaaPSODesc.RasterizerState = <span class="built_in">CD3DX12_RASTERIZER_DESC</span> (D3D12_DEFAULT);</span><br><span class="line">msaaPSODesc.BlendState = <span class="built_in">CD3DX12_BLEND_DESC</span> (D3D12_DEFAULT);</span><br><span class="line">msaaPSODesc.DepthStencilState = <span class="built_in">CD3DX12_DEPTH_STENCIL_DESC</span> (D3D12_DEFAULT);</span><br><span class="line">msaaPSODesc.SampleMask = D3D12_DEFAULT_SAMPLE_MASK;</span><br><span class="line">msaaPSODesc.PrimitiveTopologyType = D3D12_PRIMITIVE_TOPOLOGY_TYPE_TRIANGLE;</span><br><span class="line">msaaPSODesc.NumRenderTargets = <span class="number">1</span>;</span><br><span class="line">msaaPSODesc.RTVFormats[<span class="number">0</span>] = DXGI_FORMAT_R8G8B8A8_UNORM;</span><br><span class="line">msaaPSODesc.SampleDesc.Count = <span class="number">4</span>;</span><br><span class="line">msaaPSODesc.SampleDesc.Quality = <span class="number">0</span>;</span><br><span class="line">msaaPSODesc.DSVFormat = DXGI_FORMAT_D24_UNORM_S8_UINT;</span><br><span class="line"></span><br><span class="line">ID3D12PipelineState* msaaPipelineState;</span><br><span class="line">device-&gt;<span class="built_in">CreateGraphicsPipelineState</span> (&amp;msaaPSODesc, <span class="built_in">IID_PPV_ARGS</span> (&amp;msaaPipelineState));</span><br></pre></td></tr></table></figure><p>Pipiline中的SampleDesc的設置需要與Buffer一致。所以<code>Count = 4</code>以及<code>Quality = 0</code>。</p><h4 id="Draw">Draw</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">D3D12_RESOURCE_BARRIER barrierDesc = &#123;&#125;;</span><br><span class="line">barrierDesc.Type = D3D12_RESOURCE_BARRIER_TYPE_TRANSITION;</span><br><span class="line">barrierDesc.Flags = D3D12_RESOURCE_BARRIER_FLAG_NONE;</span><br><span class="line">barrierDesc.Transition.pResource = msaaRenderTarget;</span><br><span class="line">barrierDesc.Transition.Subresource = D3D12_RESOURCE_BARRIER_ALL_SUBRESOURCES;</span><br><span class="line">barrierDesc.Transition.StateBefore = D3D12_RESOURCE_STATE_RESOLVE_SOURCE;</span><br><span class="line">barrierDesc.Transition.StateAfter = D3D12_RESOURCE_STATE_RENDER_TARGET;</span><br><span class="line">cmdList-&gt;<span class="built_in">ResourceBarrier</span> (<span class="number">1</span>, &amp;barrierDesc);</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> rtvH = msaaRTVHeap-&gt;<span class="built_in">GetCPUDescriptorHandleForHeapStart</span> ();</span><br><span class="line"><span class="keyword">auto</span> dsvH = msaaDSVHeap-&gt;<span class="built_in">GetCPUDescriptorHandleForHeapStart</span> ();</span><br><span class="line">cmdList-&gt;<span class="built_in">ClearRenderTargetView</span> (rtvH, Colors::LightSteelBlue, <span class="number">0</span>, <span class="literal">nullptr</span>);</span><br><span class="line">cmdList-&gt;<span class="built_in">ClearDepthStencilView</span> (dsvH, D3D12_CLEAR_FLAG_DEPTH | D3D12_CLEAR_FLAG_STENCIL,</span><br><span class="line">                                <span class="number">1.0f</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="literal">nullptr</span>);</span><br><span class="line">cmdList-&gt;<span class="built_in">OMSetRenderTargets</span> (<span class="number">1</span>, &amp;rtvH, <span class="literal">true</span>, &amp;dsvH);</span><br><span class="line"></span><br><span class="line">ID3D12DescriptorHeap* descriptorHeaps[] = &#123;cbvHeap&#125;;</span><br><span class="line">cmdList-&gt;<span class="built_in">SetGraphicsRootSignature</span> (rootSignature);</span><br><span class="line">cmdList-&gt;<span class="built_in">SetDescriptorHeaps</span> (_countof (descriptorHeaps), descriptorHeaps);</span><br><span class="line">cmdList-&gt;<span class="built_in">SetGraphicsRootDescriptorTable</span> (<span class="number">0</span>, cbvHeap-&gt;<span class="built_in">GetGPUDescriptorHandleForHeapStart</span> ());</span><br><span class="line"></span><br><span class="line">cmdList-&gt;<span class="built_in">IASetVertexBuffers</span> (<span class="number">0</span>, <span class="number">1</span>, &amp;vbView);</span><br><span class="line">cmdList-&gt;<span class="built_in">IASetIndexBuffer</span> (&amp;ibView);</span><br><span class="line">cmdList-&gt;<span class="built_in">IASetPrimitiveTopology</span> (D3D_PRIMITIVE_TOPOLOGY_TRIANGLELIST);</span><br><span class="line"></span><br><span class="line">cmdList-&gt;<span class="built_in">DrawIndexedInstanced</span> (indices.<span class="built_in">size</span> (), <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">barrierDesc.Transition.StateBefore = D3D12_RESOURCE_STATE_RENDER_TARGET;</span><br><span class="line">barrierDesc.Transition.StateAfter = D3D12_RESOURCE_STATE_RESOLVE_SOURCE;</span><br><span class="line">cmdList-&gt;<span class="built_in">ResourceBarrier</span> (<span class="number">1</span>, &amp;barrierDesc);</span><br><span class="line"></span><br><span class="line">barrierDesc = CD3DX12_RESOURCE_BARRIER::<span class="built_in">Transition</span> (backBuffers[currentBackBuffer],</span><br><span class="line">                            D3D12_RESOURCE_STATE_PRESENT, D3D12_RESOURCE_STATE_RESOLVE_DEST);</span><br><span class="line">cmdList-&gt;<span class="built_in">ResourceBarrier</span> (<span class="number">1</span>, &amp;barrierDesc);</span><br><span class="line">cmdList-&gt;<span class="built_in">ResolveSubresource</span> (backBuffers[currentBackBuffer],</span><br><span class="line">                            <span class="number">0</span>, msaaRenderTarget, <span class="number">0</span>, DXGI_FORMAT_R8G8B8A8_UNORM);</span><br><span class="line"></span><br><span class="line">barrierDesc = CD3DX12_RESOURCE_BARRIER::<span class="built_in">Transition</span> (</span><br><span class="line">backBuffers[currentBackBuffer],</span><br><span class="line">D3D12_RESOURCE_STATE_RESOLVE_DEST,</span><br><span class="line">D3D12_RESOURCE_STATE_PRESENT</span><br><span class="line">);</span><br><span class="line">cmdList-&gt;<span class="built_in">ResourceBarrier</span> (<span class="number">1</span>, &amp;barrierDesc);</span><br><span class="line"></span><br><span class="line">cmdList-&gt;<span class="built_in">Close</span> ();</span><br><span class="line"></span><br><span class="line">ID3D12CommandList* cmdLists[] = &#123;cmdList&#125;;</span><br><span class="line">cmdQueue-&gt;<span class="built_in">ExecuteCommandLists</span> (_countof (cmdLists), cmdLists);</span><br><span class="line"></span><br><span class="line">swapChain-&gt;<span class="built_in">Present</span> (<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">currentBackBuffer = (currentBackBuffer + <span class="number">1</span>) % <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">cmdQueue-&gt;<span class="built_in">Signal</span> (fence, ++fenceValue);</span><br><span class="line"><span class="keyword">if</span> (fence-&gt;<span class="built_in">GetCompletedValue</span> () != fenceValue) &#123;</span><br><span class="line">    <span class="keyword">auto</span> event = <span class="built_in">CreateEvent</span> (<span class="literal">nullptr</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">nullptr</span>);</span><br><span class="line">    fence-&gt;<span class="built_in">SetEventOnCompletion</span> (fenceValue, event);</span><br><span class="line">    <span class="built_in">WaitForSingleObject</span> (event, INFINITE);</span><br><span class="line">    <span class="built_in">CloseHandle</span> (event);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>需要先渲染到MSAA的Buffer中，並解析到BackBuffer。<code>ResolveSubresource()</code>將MSAA資源複制到非MSAA資源中。</p><h3 id="結果對比">結果對比</h3><p>點擊圖片放大查看</p><table><thead><tr><th>Origin</th><th>MSAA</th></tr></thead><tbody><tr><td><img src="/img/dx/msaa/box.png" alt="Origin"></td><td><img src="/img/dx/msaa/msaa_box.png" alt="MSAA"></td></tr></tbody></table><h3 id="總結">總結</h3><p>因為MSAA算法已經包含在GPU中，所以只需要直接使用便可(實現原理也不難，可以自行上網搜索)。渲染的方式與關閉MSAA時基本一致。但是需要一個MSAA用的RTV、DSV以及Pipeline。</p><p>在渲染時先渲染到MSAA的RenderTarget上，然後通過<code>ResolveSubresource ()</code>將其複制到後台緩衝中。</p><p>that’s all!</p><h3 id="Reference">Reference</h3><ol><li><a href="https://zhuanlan.zhihu.com/p/460439298">DirectX 12小技巧-启用MSAA</a></li><li><a href="https://0-rpg.com/2022/08/05/cg/Introducation-of-MultisamplingAnti-Aliasing-MSAA/">Introduction of Multisampling</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> DirectX </category>
          
      </categories>
      
      
        <tags>
            
            <tag> directx </tag>
            
            <tag> anti-aliasing </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Compile HLSL with fxc</title>
      <link href="/2022/07/31/directx/Compile-HLSL-with-fxc/"/>
      <url>/2022/07/31/directx/Compile-HLSL-with-fxc/</url>
      
        <content type="html"><![CDATA[<blockquote><p>Environments:</p><ul><li>Windows 10</li><li>DirectX 12</li></ul></blockquote><div class="tabs" id="tab"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#tab-1">中文</button></li><li class="tab"><button type="button" data-href="#tab-2">日本語</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="tab-1"><p>HLSL的編譯主要可以通過</p><ul><li>fxc.exe</li><li>Visual Studio</li><li>動態編譯</li></ul><p>這篇文章介紹如何用<code>fxc.exe</code>編譯HLSL。</p><h3 id="fxc-exe的環境變數">fxc.exe的環境變數</h3><p>在Windows 8開始，DirectX SDK已經整合到Windows SDk中。<br>在Windows 10中，<code>fxc.exe</code>可以在以下路徑找到。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Program Files (x86)\Windows Kits\10\bin\10.0.19041.0\x86</span><br></pre></td></tr></table></figure><p>將路徑加入到環境變數中的<strong>Path</strong>後，在<code>cmd</code>中就可以使用。</p><h3 id="開始編譯">開始編譯</h3><p>在<code>cmd</code>中，輸入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// Debug Mode</span><br><span class="line">fxc &quot;color.hlsl&quot; /Od /Zi /T vs_5_0 /E &quot;VS&quot; /Fo &quot;color_vs.cso&quot; /Fc &quot;color_vs.asm&quot;</span><br><span class="line">fxc &quot;color.hlsl&quot; /Od /Zi /T ps_5_0 /E &quot;PS&quot; /Fo &quot;color_ps.cso&quot; /Fc &quot;color_ps.asm&quot;</span><br><span class="line"></span><br><span class="line">// Release Mode</span><br><span class="line">fxc &quot;color.hlsl&quot; /T vs_5_0 /E &quot;VS&quot; /Fo &quot;color_vs.cso&quot; /Fc &quot;color_vs.asm&quot;</span><br><span class="line">fxc &quot;color.hlsl&quot; /T ps_5_0 /E &quot;PS&quot; /Fo &quot;color_ps.cso&quot; /Fc &quot;color_ps.asm&quot;</span><br></pre></td></tr></table></figure><table><thead><tr><th>參數</th><th>作用</th></tr></thead><tbody><tr><td>/Od</td><td>禁用優化</td></tr><tr><td>/Zi</td><td>開啟調試信息</td></tr><tr><td>/T</td><td>Shader Model</td></tr><tr><td>/E</td><td>Shader的入口點(Entry Point)</td></tr><tr><td>/Fo</td><td>編譯後的文件名，一般以.cso作為後綴</td></tr><tr><td>/Fc</td><td>Shader的匯編文檔</td></tr></tbody></table><p>匯編文檔的輸出可以省略。其它參數可以在官方文檔找到。</p><h3 id="DX中的讀取">DX中的讀取</h3><p>最後在DX程序中，讀取編譯好的<code>.cso</code>文檔，並轉換成<code>ID3DBlob</code>便可。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="tab-2"><p>主なHLSLのコンパイルの方法は、以下のようにする。</p><ul><li>fxc.exe</li><li>Visual Studioに提供されたコンパイル</li><li>dynamic compile (runtime)</li></ul><p>ここでは、<code>fxc.exe</code>でコンパイルの方法を紹介する。</p><h3 id="fxc-exeの環境変数の設定">fxc.exeの環境変数の設定</h3><p>Windows 8から、DirectX SDKが既にWindows SDKに含まれていた。<br>Windows 10では、<code>fxc.exe</code>が以下のパスで見つけることができる。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Program Files (x86)\Windows Kits\10\bin\10.0.19041.0\x86</span><br></pre></td></tr></table></figure><p>このパスを環境変数の<strong>Path</strong>に導入し、<code>cmd</code>で使用できるようになる。</p><h3 id="コンパイルスタート">コンパイルスタート</h3><p><code>cmd</code>で、以下のコードをインプットする。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// Debug Mode</span><br><span class="line">fxc &quot;color.hlsl&quot; /Od /Zi /T vs_5_0 /E &quot;VS&quot; /Fo &quot;color_vs.cso&quot; /Fc &quot;color_vs.asm&quot;</span><br><span class="line">fxc &quot;color.hlsl&quot; /Od /Zi /T ps_5_0 /E &quot;PS&quot; /Fo &quot;color_ps.cso&quot; /Fc &quot;color_ps.asm&quot;</span><br><span class="line"></span><br><span class="line">// Release Mode</span><br><span class="line">fxc &quot;color.hlsl&quot; /T vs_5_0 /E &quot;VS&quot; /Fo &quot;color_vs.cso&quot; /Fc &quot;color_vs.asm&quot;</span><br><span class="line">fxc &quot;color.hlsl&quot; /T ps_5_0 /E &quot;PS&quot; /Fo &quot;color_ps.cso&quot; /Fc &quot;color_ps.asm&quot;</span><br></pre></td></tr></table></figure><table><thead><tr><th>パラメータ</th><th>作用</th></tr></thead><tbody><tr><td>/Od</td><td>最適化無効</td></tr><tr><td>/Zi</td><td>デバッグモード</td></tr><tr><td>/T</td><td>Shader Model</td></tr><tr><td>/E</td><td>ShaderのEntry Point</td></tr><tr><td>/Fo</td><td>コンパイルしたファイル名。拡張子は普通<code>.cso</code>にする</td></tr><tr><td>/Fc</td><td>Shaderのアセンブリ</td></tr></tbody></table><p>アセンブリのアウトプットは必要ではない。ほかのパラメータは公式サイトで調べてください。</p><h3 id="DXでの読み込み">DXでの読み込み</h3><p>コンパイルした後、DXアプリケーションで<code>.cso</code>を読み込んで、<code>ID3DBlob</code>を作ることです。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> DirectX </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hlsl </tag>
            
            <tag> directx </tag>
            
            <tag> compile </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Custom HTTPS domain on Github Pages with CloudFlare</title>
      <link href="/2022/03/29/Custom-HTTPS-domain-on-Github-Pages-with-CloudFlare/"/>
      <url>/2022/03/29/Custom-HTTPS-domain-on-Github-Pages-with-CloudFlare/</url>
      
        <content type="html"><![CDATA[<h3 id="Prepare">Prepare</h3><ul><li>Register a account on <a href="https://www.cloudflare.com/">CloudFlare</a> and buy a domain.</li><li>Make sure you have created your Blog on Github Page. If you haven’t started a Blog yet, check out the <a href="https://www.0-rpg.com/2022/03/29/Setup-Github-Page-with-hexo/">previous post</a>.</li></ul><h3 id="CloudFlare">CloudFlare</h3><ul><li>Goto your domain.<br><img src="/img/custom_https_domain_on_github_pages_with_cloudflare/01.webp" alt="01"></li><li>Goto DNS page.<br><img src="/img/custom_https_domain_on_github_pages_with_cloudflare/02.webp" alt="02"></li><li>Add two record, <code>A</code> &amp; <code>CNAME</code><br><img src="/img/custom_https_domain_on_github_pages_with_cloudflare/03.webp" alt="03"><br>The <code>Name</code> in <code>A</code> is your domain name (<a href="http://xxx.com">xxx.com</a>). The <code>Content</code> in <code>A</code> is your Github Page’s IP, and you can open <code>cmd</code> and enter <code>ping</code> to get the IP.<br><img src="/img/custom_https_domain_on_github_pages_with_cloudflare/04.webp" alt="04"><br>The <code>Name</code> in <code>CNAME</code> is www. The <code>Content</code> in <code>CNAME</code> is your Github Page.</li><li>Goto SSL/TLS &gt; Edge Certificates page, and check <code>Always Use HTTPS</code><br><img src="/img/custom_https_domain_on_github_pages_with_cloudflare/05.webp" alt="05"></li></ul><h3 id="Github-Page">Github Page</h3><ul><li>Goto Setting &gt; Pages, and enter your domain in <code>Custom domain</code> and Save.<br><img src="/img/custom_https_domain_on_github_pages_with_cloudflare/06.webp" alt="06"></li></ul><h3 id="Final">Final</h3><ul><li>Open the Blog folder and goto the <code>source</code> folder.<br><img src="/img/custom_https_domain_on_github_pages_with_cloudflare/07.webp" alt="07"></li><li>Create a <code>CNAME</code> file under the <code>source</code> folder.<br><img src="/img/custom_https_domain_on_github_pages_with_cloudflare/08.webp" alt="08"></li><li>As shown, enter your domain name.<br><img src="/img/custom_https_domain_on_github_pages_with_cloudflare/09.webp" alt="09"></li><li>Finally, <code>hexo g</code> and <code>hexo d</code> were re-uploaded to Github.</li></ul>]]></content>
      
      
      <categories>
          
          <category> Tutorials </category>
          
      </categories>
      
      
        <tags>
            
            <tag> github </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Setup-Github-Page-with-Hexo</title>
      <link href="/2022/03/29/Setup-Github-Page-with-Hexo/"/>
      <url>/2022/03/29/Setup-Github-Page-with-Hexo/</url>
      
        <content type="html"><![CDATA[<blockquote><p><strong>Environments:</strong></p><ul><li>Windows 10 64-bit</li><li>git 2.28.0.windows.1</li><li>Node.js v16.14.2</li><li>npm 8.5.0</li></ul></blockquote><h3 id="Prepare">Prepare</h3><ul><li><p>Download and install <a href="https://git-scm.com/">git</a>.</p></li><li><p>Download and install <a href="https://nodejs.org/en/">Node.js</a>.</p></li></ul><h3 id="Github">Github</h3><h4 id="Register-Github-account-and-Create-a-new-repository">Register Github account and Create a new repository</h4><ul><li>Goto the <a href="https://github.com/">Github</a> page and register your account.</li></ul><p><img src="/img/setup_github_page_with_hexo/01.webp" alt="01"></p><ul><li>Click the <code>New</code> button in the webpage left side.</li></ul><p><img src="/img/setup_github_page_with_hexo/02.webp" alt="02"></p><ul><li><p>Input data.</p><p><img src="/img/setup_github_page_with_hexo/03.webp" alt="03"></p><ol><li><p>Enter <code>Repository name</code>. You need to replace <code>username</code> with your username.</p><p>You can see your username in the upper right corner.<img src="/img/setup_github_page_with_hexo/04.webp" alt="04"></p></li><li><p>Check <code>Add a README file</code> [Optional]</p></li><li><p>Click <code>Create repository</code></p></li></ol></li></ul><h4 id="SSH-Key">SSH Key</h4><ul><li><p>Right-click anywhere and click <code>Git Bash Here</code>.</p><p><img src="/img/setup_github_page_with_hexo/05.webp" alt="05"></p></li><li><p>Enter <code>ssh-keygen -t ras -C EmailAddress</code> (replace <code>EmailAdress</code> with your email adress).</p><p><img src="/img/setup_github_page_with_hexo/06.webp" alt="06"></p><p>After, use the default settings (press Enter) as shown in the following image.</p><p><img src="/img/setup_github_page_with_hexo/07.webp" alt="07"></p></li><li><p>Enter <code>cat ~/.ssh/id_rsa.pub</code>. Copy the string of text that is displayed.</p><p><img src="/img/setup_github_page_with_hexo/08.webp" alt="08"></p></li><li><p>Goto the SSH key setting on Github.</p><p><img src="/img/setup_github_page_with_hexo/09.webp" alt="09"><br><img src="/img/setup_github_page_with_hexo/10.webp" alt="10"></p></li><li><p>Click <code>New SSH key</code>.</p><p><img src="/img/setup_github_page_with_hexo/11.webp" alt="11"></p></li><li><p>Input <code>Title</code> (custom) and paste the <code>Key</code> that you just copied.</p><p><img src="/img/setup_github_page_with_hexo/12.webp" alt="12"></p></li><li><p>Finally, you’re done setting up Github.</p><p><img src="/img/setup_github_page_with_hexo/13.webp" alt="13"></p></li></ul><h3 id="Hexo">Hexo</h3><ul><li><p>Everything is entered in <code>Git Bash</code>.</p></li><li><p>You can also check out the documentation on <a href="https://hexo.io/">Hexo</a>.</p></li></ul><h4 id="Install-Hexo">Install Hexo</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-cli -g  </span><br></pre></td></tr></table></figure><h4 id="Setup-your-blog">Setup your blog</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo init GithubBlog  </span><br><span class="line">cd GithubBlog  </span><br></pre></td></tr></table></figure><p>You can find the <code>GithubBlog</code> folder.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># Folder structure.  </span><br><span class="line">.  </span><br><span class="line">├── _config.yml # configuration  </span><br><span class="line">├── package.json   </span><br><span class="line">├── scaffolds # templates folder  </span><br><span class="line">├── source  # post &amp; page folder  </span><br><span class="line">|   ├── _drafts # draft folder  </span><br><span class="line">|   └── _posts # blog post folder   </span><br><span class="line">└── themes  # theme folder  </span><br></pre></td></tr></table></figure><h4 id="Create-a-new-post">Create a new post</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new post &quot;new post&quot;  </span><br></pre></td></tr></table></figure><h4 id="Local-Server">Local Server</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo s  </span><br></pre></td></tr></table></figure><p>Open your browser and type <code>http://localhost:4000/</code>.</p><p><img src="/img/setup_github_page_with_hexo/14.webp" alt="14"></p><h4 id="Deploy-to-Github">Deploy to Github</h4><ul><li><p>Install a deployment plugin.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save  </span><br></pre></td></tr></table></figure></li><li><p>Goto the <code>GithubBlog</code> folder, open the <code>_cofig.yml</code> file, locate the <code>deploy</code> and enter the following</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy:  </span><br><span class="line">  type: git  </span><br><span class="line">  repo: git@github.com:username/username.github.io.git  </span><br><span class="line">  branch: master  </span><br></pre></td></tr></table></figure><p>SSH link entered in the <code>repo</code> can be retrieved from the repository, as shown below</p><p><img src="/img/setup_github_page_with_hexo/15.webp" alt="15"></p></li><li><p>Generate &amp; Deploy</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo g  </span><br><span class="line">hexo d -m &quot;First&quot;   </span><br><span class="line"># -m &quot;&quot; You can enter a description of the content of this update  </span><br></pre></td></tr></table></figure></li><li><p>In Github repository.</p><p><img src="/img/setup_github_page_with_hexo/16.webp" alt="16"></p></li><li><p>Finally, type in your browser: <code>username.github.io</code>.</p></li></ul><p>​ <img src="/img/setup_github_page_with_hexo/17.webp" alt="17"></p><h4 id="Find-theme-Optional">Find theme (Optional)</h4><p>You can find your favorite theme on <a href="https://hexo.io/themes/">themes</a> that will make your Blog look better.</p><p>The theme I’m using is <a href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a>.</p><p>For details, please refer to the theme documentation.</p>]]></content>
      
      
      <categories>
          
          <category> Tutorials </category>
          
      </categories>
      
      
        <tags>
            
            <tag> github </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Markdown Test</title>
      <link href="/2022/03/29/Markdown-Test/"/>
      <url>/2022/03/29/Markdown-Test/</url>
      
        <content type="html"><![CDATA[<h1>Title1</h1><h2 id="Title2">Title2</h2><h3 id="Title3">Title3</h3><h4 id="Title4">Title4</h4><h5 id="Title5">Title5</h5><h6 id="Title6">Title6</h6><h3 id="Code-Block">Code Block</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">namespace</span> <span class="title">Game</span></span><br><span class="line">    <span class="title">public</span> <span class="title">class</span> <span class="title">GameDeveloper</span> &#123;</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span> ()</span> &#123;</span><br><span class="line">Console.WriteLine (<span class="string">&quot;I am a game developer.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>A game developer</code></p><h3 id="Image">Image</h3><p><img src="/img/icon.webp" alt="icon"></p><h3 id="Link">Link</h3><p><a href="https://0-rpg.com">零君</a></p><h3 id="Blockquotes">Blockquotes</h3><blockquote><p>A game developer.</p><blockquote><p>A game developer</p></blockquote></blockquote><blockquote><p><code>code element</code></p></blockquote><h3 id="List">List</h3><ul><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li></ul><ol><li>a</li><li>b</li><li>c</li><li>d</li><li>e</li></ol><h3 id="Table">Table</h3><table><thead><tr><th>Header1</th><th>Header2</th><th>Header3</th></tr></thead><tbody><tr><td>A</td><td>game</td><td>developer</td></tr></tbody></table><h3 id="Emphasis-Bold-Text">Emphasis Bold Text</h3><p><strong>A game developer</strong></p><p><em><strong>A game developer</strong></em></p><p><s>A game developer</s></p><h3 id="Katex">Katex</h3><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>E</mi><mo>=</mo><mi>m</mi><msup><mi>c</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">E = mc^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8641em;"></span><span class="mord mathnormal">m</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>=</mo><mi>m</mi><msup><mi>c</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">E = mc^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord mathnormal">m</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
